{{define "modules/server"}}
        <!-- Tab: Server -->
        <div x-show="currentTab === 'server'" class="p-4 md:p-0 space-y-4" x-transition:enter="transition ease-out duration-200">
            <template x-for="(items, section) in serverSections" :key="section">
                <!-- 这里的 items 是当前分组下的所有配置项 -->
                <div tabindex="0" class="collapse collapse-arrow border border-base-200 bg-base-100 rounded-box shadow-sm">
                    <input type="checkbox" checked /> 
                    <div class="collapse-title text-base font-bold flex items-center gap-2">
                        <span class="w-1 h-6 bg-primary rounded-full"></span>
                        <span x-text="section"></span>
                    </div>
                    <div class="collapse-content pt-2">
                        <!-- 专门用来渲染 Mods 按钮 (只有当当前分组包含 Mods 字段时才会显示) -->
                        <template x-for="modItem in items.filter(i => i.key === 'Mods')" :key="'mod-btn-'+modItem.key">
                            <div class="bg-base-200/80 p-4 rounded-lg border border-primary/30 flex flex-col md:flex-row justify-between items-center gap-4 mb-4">
                                <div class="flex items-center gap-3">
                                    <div class="p-2 bg-primary/10 rounded-full text-primary">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" /></svg>
                                    </div>
                                    <div>
                                        <!-- 标题 -->
                                        <div class="font-bold text-base" x-text="i18n.mod_section_title"></div>
                                        <!-- 描述 -->
                                        <div class="text-xs opacity-60" x-text="i18n.mod_section_desc"></div>
                                    </div>
                                </div>
                                <button class="btn btn-primary btn-sm md:btn-md gap-2 w-full md:w-auto" @click="openModManager()">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25" /></svg>
                                    <!-- 按钮文字 -->
                                    <span x-text="i18n.mod_btn_open_manager"></span>
                                </button>
                            </div>
                        </template>

                        <!-- 渲染普通字段的 Grid (过滤掉 Mods 和 WorkshopItems) -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                            <template x-for="item in items.filter(i => i.key !== 'Mods' && i.key !== 'WorkshopItems')" :key="item.key">
                                <fieldset class="fieldset bg-base-200/50 border-base-200 border rounded-lg p-3">
                                    <legend class="fieldset-legend text-xs font-bold text-primary px-2 uppercase tracking-wide" x-text="item.key || item.label"></legend>
                                    
                                    <label class="label py-0 pb-1">
                                        <span class="label-text-alt font-mono text-[10px] opacity-50 select-text" x-text="item.label"></span>
                                    </label>

                                    <template x-if="item.options">
                                        <select class="select select-bordered select-sm w-full mt-1" x-model="item.value">
                                            <template x-for="opt in item.options" :key="opt.value">
                                                <option :value="opt.value" x-text="opt.label"></option>
                                            </template>
                                        </select>
                                    </template>
                                    
                                    <template x-if="!item.options">
                                        <input type="text" class="input input-bordered input-sm w-full mt-1" x-model="item.value" />
                                    </template>
                                    
                                    <div class="mt-1 text-[10px] text-base-content/60 leading-tight truncate" x-text="item.tooltip" :title="item.tooltip"></div>
                                </fieldset>
                            </template>
                        </div>

                    </div>
                </div>
            </template>

            <!-- 浮动保存按钮 (Desktop) -->
            <div class="hidden md:flex fixed bottom-8 right-8 gap-3 z-40">
                <button class="btn btn-neutral shadow-lg gap-2" @click="saveConfig('server', false)">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M11.25 4.5l7.5 7.5-7.5 7.5m-6-15l7.5 7.5-7.5 7.5" /></svg>
                    <span x-text="i18n.btn_save"></span>
                </button>
                <button class="btn btn-primary shadow-lg gap-2" @click="saveConfig('server', true)">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" /></svg>
                    <span x-text="i18n.btn_save_restart"></span>
                </button>
            </div>
             <!-- 移动端保存按钮 (底部固定) -->
             <div class="md:hidden grid grid-cols-2 gap-2 mt-4">
                <button class="btn btn-neutral" @click="saveConfig('server', false)"><span x-text="i18n.btn_save"></span></button>
                <button class="btn btn-primary" @click="saveConfig('server', true)"><span x-text="i18n.btn_save_restart"></span></button>
            </div>
        </div>
{{end}}
